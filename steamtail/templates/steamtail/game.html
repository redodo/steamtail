{% load steamtail %}
<div class="game">
    <div class="game__header">

        {% if size == "large" %}
        {# TODO: the capsule image sometimes does not exist #}
        <img class="game__image" src="{{ app.get_image_url }}">
        {% elif size == "small" %}
        <img class="game__image" src="{{ app.get_small_image_url }}">
        {% else %}
        <img class="game__image" src="{{ app.get_image_url }}">
        {% endif %}

        <div class="game__overlay">
        </div>

    </div>
    <div class="game__info">

        {% if not exclude_tags %}
        <div class="game__tags">
            <span class="tag {% if size == "small" %} tag--small{% endif %}">{{ app.name }}</span>
            <span class="tag tag--green{% if size == "small" %} tag--small{% endif %}">
                {% if app.review_score %}
                {{ app.review_score|perc }}
                {% elif app.coming_soon or not app.release_date %}
                    Coming Soon
                    {% else %}
                    No Reviews
                {% endif %}
            </span>
            {% with tags=app.apptag_set.all|select_related:"tag"|slice:":12" %}
                {% with top=tags|first %}
                    {% for tag in tags %}
                    <span title="{{ tag.votes }} votes ({{ tag.share|perc }})" class="tag tag--blue{% if size == "small" %} tag--small{% endif %}" style="opacity:{{ tag.share|div:top.share|safe }}">{{ tag.tag.name }}</span>
                    {% endfor %}
                {% endwith %}
            {% endwith %}
            <div class="game__tags-fader"></div>
        </div>
        {% endif %}

    </div>
</div>
